{
  "tests": [
    {
      "description": "Plaintext envelope is signed with sender identity (dummy mode)",
      "direction": "apply",
      "given": {
        "envelope": "plaintext",
        "data": {"type": "message", "content": "Hello"},
        "metadata": {},
        "env": {"CRYPTO_MODE": "dummy"}
      },
      "then": {
        "envelope": "signed",
        "data": {"type": "message", "content": "Hello"},
        "metadata": {
          "sender": "test-user",
          "signature": "dummy_sig_*"
        }
      }
    },
    {
      "description": "Plaintext envelope is signed with real crypto",
      "direction": "apply",
      "given": {
        "envelope": "plaintext",
        "data": {"type": "message", "content": "Test message for signing"},
        "metadata": {},
        "identity": "test-user",
        "env": {"CRYPTO_MODE": "real"}
      },
      "then": {
        "envelope": "signed",
        "data": {"type": "message", "content": "Test message for signing"},
        "metadata": {
          "sender": "test-user",
          "signature": "*"
        }
      }
    }
  ]
}